# Creating an executable

## Exporting scene code

The final step in creating a 64k! Our code is mostly autogenerated by "build/generate.py".

Pro-tip: open generate.py and find the call roundb(v, 32) , changing that 32 to a lower number
will start truncating floating point data. I found half precision to be adequate for all animation
data except uOrigin.

To run it, open a command prompt inside the build folder (by typing cmd in the address bar), and then type:
python generate.py

Running this script will find the last open project and write to "Player/generated.hpp".

## Compiling Player project

Inside Player/ you will find a Visual Studio project. It should build with VS2015 (or newer).

### Resolution 
See DEMO_WIDTH and DEMO_HEIGHT in settings.h

### Audio
Is on by default, but you can disable it and jump to a certain point in the demo for debugging. Look for NO_AUDIO in settings.h, and START_BEAT.

### Loading bar
There is a hard coded fragment shader in const char* loader that draws a loading bar. Feel free
to change the shader behind it. The loading bar gets a uniform vec4 u with a [0-1] loaded state,
width in pixels, height in pixels, fade (for some reason we fade it in over a few frames before we
start precalc).

The last "loading" step is drawing a first frame to make sure all textures are precalced before we
start the music, so expect the loader to hang for a while at that point.

## Integrating third-party sound systems

The player doesn't include any sound system by default. But it does allow easy integration of them.

### 64Klang2

To integrate 64Klang2 you need to download all .h and .cpp files from the 64Klang2 player code from here:
https://github.com/hzdgopher/64klang/tree/master/Player/Player
And copy them to SqrMelon/Player/64klang2/

You'll also need an actual soundtrack. A musician with the 64klang2 VSTi should be able to export the patch and record note data to these 2 files:
64k2Patch.h
64k2Song.h
Which you then also add in SqrMelon/Player/64klang2/

As a last step open settings.h and make sure AUDIO_64KLANG2 is defined (and NO_AUDIO isn't and none of the other AUDIO_XXXXX are either.).

### WaveSabre

To integrate WaveSabre you first need to follow these steps:

1. download the WaveSabre source code from here: https://github.com/thijskruithof/WaveSabre
2. Create a subfolder SqrMelon/Player/WaveSabre 
3. Copy from the downloaded WaveSabre folder the WaveSabreCore folder and the WaveSabrePlayerLib folder (including all their subfolders) to SqrMelon/Player/WaveSabre/ 
4. Add all the .cpp files from the `SqrMelon/Player/WaveSabre/WaveSabreCore/src/` and from `SqrMelon/Player/WaveSabre/WaveSabrePlayerLib/src/` to the WaveSabre filter in the Player project in VS
5. You'll also need an actual soundtrack. A musician can make one with the WaveSabre VSTi plugins and use the WaveSabre Project Manager tool to generate a header file. Copy this head filer to SqrMelon/Player/WaveSabre/ and rename it to music.h.
6. As a last step open settings.h and make sure AUDIO_WAVESABRE is defined (and NO_AUDIO isn't and none of the other AUDIO_XXXXX are either.).


## Executable compression

The generated Player.exe is not compressed by default. But if you like to have it compressed, we advise you to set up an addition post build step in the Player's project config.

One recommended executable compressor is kkrunchy (version a), which can be downloaded from here:
http://www.farbrausch.de/~fg/kkrunchy/



